<!DOCTYPE html>
<html lang="en">
<head>
    <title>xeogl Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <script src="../build/xeogl.js"></script>
    <script src="js/models/glTFModel.js"></script>

    <link href="css/styles.css" rel="stylesheet"/>

<body>

<div id="info" class="light">
    <h1>pick masking - using the "excludeMeshes" option to exclude meshes from being picked</h1>
    <br>
    <ul>
        <li>load a <a href="../docs/classes/GLTFModel.html" target="_parent">GLTFModel</a></li>
        <li>pick and highlight Meshes on mouse-over, except "gearbox#74.0" and "gearbox#84.0"</li>
        <li>other meshes are pickable <em>through</em> those two Meshes</li>
        <li>model by <a href="https://sketchfab.com/tflexcad" target="_parent">https://sketchfab.com/tflexcad</a></li>
    </ul>
</div>


<script>

    var scene = xeogl.scene;
    var camera = scene.camera;
    var input = scene.input;

    // Load glTF model

    var model = new xeogl.GLTFModel({
        id: "gearbox",
        src: "models/gltf/gearbox_conical/scene.gltf",
        lambertMaterials: true,
        ghostEdgeThreshold: 10,
        scale: [100, 100, 100]
    });

    // Position the camera

    camera.eye = [-13.78, -1.52, -13.00];
    camera.look = [-2.53, -4.90, -0.10];
    camera.up = [0.11, 0.97, 0.14];

    // Camera interaction

   var cameraControl =  new xeogl.CameraControl();

    cameraControl.on("picked", function (e) {
        console.log(e.mesh.id)
    });

    // Highlight everything but the excluded Meshes on mouseover

    var lastEntity = null;

    input.on("mousemove", function (coords) {

        var hit = scene.pick({
            canvasPos: coords,
            excludeMeshes: [
                "gearbox#74.0",
                "gearbox#84.0"
            ]
        });

        if (hit) {
            if (lastEntity) {
                if (lastEntity.id !== hit.mesh.id) {
                    lastEntity.highlighted = false;
                } else {
                    return;
                }
            }
            hit.mesh.highlighted = true;
            lastEntity = hit.mesh;

        } else if (lastEntity) {

            lastEntity.highlighted = false;
            lastEntity = null;
        }
    });


</script>
</body>
</html>